# RenderStreamNinja
 ===Description:
 
 UE4 template for use with the disguise RenderStream plugin, currently focused on the use of front and back plate components.
 
 This template may be expanded or improved upon from time to time, as the plugin evolves and features like exposable parameters become more widely available. This repository is also open to contributions, should one wish to submit improvements.
 
 The blueprints are fully commented and should be fairly clear to understand and navigate. It is still recommended to read below if you wish to know more about how it actually works.
 
 
 ===The method in a nutshell:
 
 The concept is actually super simple. I've taken the same workflow we use for Notch, where d3 takes in a double-width side-by-side camera view and automatically composites it as front and back plate, and applied it in UE4. The only limitation is the fact that there IS no "multicamera" in UE4, so I just created my own.
 
 All I had to do was capture two camera views, using two scene capture components linked to the main camera's position, and selectively include/exclude elements that they will render. I then created a widget blueprint and placed the two camera components side by side, with the alpha inverted through a UI material (due to the way the scene capture components work). 
 Knowing that the RenderStream plugin bypasses any UI elements entirely, I was forced to render the widget I created as a 3D element set right in front of the camera, and set the main camera itself to render as orthographic, with the correct aspect ratio and a carefully set clipping plane to avoid rendering artefacts. It is because of this that I also offset the main camera itself (and the widget) above the stage area, hoping to avoid any nearby geometry. This offset may need to be tweaked to below the stage depending on the project.
 
 As for rendering front/back plate assets, I've created two separate classes for this and added some simple logic that decides whether to render them based on a variable in the main RenderStream blueprint, acting as a threshold. This method is super simple and has flaws, such as the lack of shadows and reflections as the object phases in and out of existence + more stuff. The reason I'm not bothered by this is because there are a million methods you could use to craft a better system, and I highly recommend you do that work yourselves and build a system that's most suitable to your projects' individual needs, as the point of this template is merely to showcase the concept of selective front/back plate rendering. 
 
 
 ===Guide:
 
 Open the Unreal Project file and click on Play in a New Editor Window (PIE).
 Press "Spacebar" to begin the RenderStream capture.
 Press the arrow keys and End + Home keys to nudge the camera's origin.
 
 Please also ensure you set the correct PIE window resolution in the Editor Settings, under "Game Viewport Settings".
 
 
 ===Known issues:
 
 - Uncompressed formats from RX machines DO NOT currently work! We are currently limited to NDI, it seems. This is due to issues sending or receiving alpha. The devs in charge of that have been notified, though the more emails you send them the merrier (probably).
 
 - 4k resolutions are as of yet untested, as I've not looked into whether you can send a horizontal resolution up to 8k. The max res tested so far has been 3840x1080 for a HD feed.
 
 - Because the widget is physically in the 3D space, and the ortho clipping plane method is ugly, you may come across rendering artefacts on your front plate that are generated by geometry rendering into the camera's view. In order to avoid this, ensure you set the camera's spawn offset far enough for it not to be near any stage element.
 
 - Objects that are not rendered by the back plate camera do not have shadows nor reflections! The shadow issue might be an easy fix, but the reflections might be a bit trickier since they're calculated in screen space. Any suggestions for a fix are welcome, I have a few in mind but won't be able to look at them for some time.
 
 - d3 might lock the origin of the spatial mapping and "snap it" back into place whenever an attempt to change it is made. I'm not sure what the fix for this is, sometimes stopping and starting the stream works, but sometimes a blood sacrifice may be necessary. A goat tends to gain more favour than a chicken, and might increase the chances of this curse being lifted. Alternative, you can try using the arrow keys for moving the origin of the camera sideways and upward, plus the Home + End buttons to move forwards and backwards.
 
 - The RenderStream plugin version differences may cause you trouble, including error messages such as "The Media Failed to Capture", or even crashes of the editor when starting the stream. Short term fix is to download whatever RenderStream Plugin folder seems to work for you, and pasting it in the project. You may also need to re-create the RenderStreamMediaOutput file, or even re-create the start/stop capture nodes at times. Long term fix, well... that's down to the plugin devs. 

 
 For any more issues or enquiries, contact Michael Adefehinti on michael@realtime.ninja
